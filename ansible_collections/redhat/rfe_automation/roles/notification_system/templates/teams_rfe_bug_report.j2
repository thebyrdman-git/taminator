{
  "@type": "MessageCard",
  "@context": "http://schema.org/extensions",
  "themeColor": "{{ teams_theme_color }}",
  "summary": "RFE/Bug Tracker Report - {{ customer_name }}",
  "sections": [
    {
      "activityTitle": "ðŸ”§ RFE/Bug Tracker Report - {{ customer_name }}",
      "activitySubtitle": "{{ account_name }} | Generated: {{ report_timestamp }}",
      "activityImage": "https://redhat.com/favicon.ico",
      "facts": [
        {
          "name": "Customer",
          "value": "{{ customer_name }}"
        },
        {
          "name": "Account",
          "value": "{{ account_name }}"
        },
        {
          "name": "Active RFEs",
          "value": "{{ active_rfes | length }}"
        },
        {
          "name": "Active Bugs",
          "value": "{{ active_bugs | length }}"
        },
        {
          "name": "Closed Cases",
          "value": "{{ closed_cases | length }}"
        },
        {
          "name": "Data Quality",
          "value": "{{ (data_quality_score * 100) | round(1) }}%"
        }
      ],
      "markdown": true
    }
    {% if active_rfes | length > 0 %}
    ,{
      "activityTitle": "ðŸŽ¯ Active RFE Cases ({{ active_rfes | length }})",
      "text": "{% for case in active_rfes[:5] %}**{{ case.caseNumber }}**: {{ case.subject[:80] }}{% if case.subject | length > 80 %}...{% endif %} ({{ case.severity if case.severity else 'N/A' }})\n\n{% endfor %}{% if active_rfes | length > 5 %}... and {{ active_rfes | length - 5 }} more cases{% endif %}",
      "markdown": true
    }
    {% endif %}
    {% if active_bugs | length > 0 %}
    ,{
      "activityTitle": "ðŸ› Active Bug Cases ({{ active_bugs | length }})",
      "text": "{% for case in active_bugs[:5] %}**{{ case.caseNumber }}**: {{ case.subject[:80] }}{% if case.subject | length > 80 %}...{% endif %} ({{ case.severity if case.severity else 'N/A' }})\n\n{% endfor %}{% if active_bugs | length > 5 %}... and {{ active_bugs | length - 5 }} more cases{% endif %}",
      "markdown": true
    }
    {% endif %}
    {% if notification_include_details and closed_cases | length > 0 %}
    ,{
      "activityTitle": "ðŸ“‹ Recent Closed Cases ({{ closed_cases | length }})",
      "text": "{% for case in closed_cases[:3] %}**{{ case.caseNumber }}**: {{ case.subject[:60] }}{% if case.subject | length > 60 %}...{% endif %}\n\n{% endfor %}{% if closed_cases | length > 3 %}... and {{ closed_cases | length - 3 }} more cases{% endif %}",
      "markdown": true
    }
    {% endif %}
  ],
  "potentialAction": [
    {
      "@type": "OpenUri",
      "name": "View Full Report",
      "targets": [
        {
          "os": "default",
          "uri": "https://access.redhat.com"
        }
      ]
    }
  ]
}
