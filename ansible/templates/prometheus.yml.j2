# Prometheus configuration for PAI Infrastructure
# Generated by Ansible - DO NOT EDIT MANUALLY
# Template: prometheus.yml.j2

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'pai-home'
    environment: 'production'

rule_files:
  - "pai_alerting_rules.yml"

alerting:
  alertmanagers:
    - static_configs:
        - targets: []
          # TODO: Configure Alertmanager if needed

scrape_configs:
  # Prometheus itself
  - job_name: 'prometheus'
    static_configs:
      - targets: ['{{ ansible_host }}:{{ prometheus_port }}']
        labels:
          instance: 'prometheus-server'
          service: 'prometheus'

  # Node Exporter - HP Server (where Prometheus runs)
  - job_name: 'node-exporter-hp'
    static_configs:
      - targets: ['{{ ansible_host }}:{{ node_exporter_port }}']
        labels:
          instance: 'hp-server'
          service: 'node-exporter'
          server_type: 'hp-miraclemax'

  # Node Exporter - Plex Server
  - job_name: 'node-exporter-plex'
    static_configs:
      - targets: ['192.168.1.17:9100']
        labels:
          instance: 'plex-server'
          service: 'node-exporter'
          server_type: 'media-server'

  # PAI Portal Health Monitoring
  - job_name: 'pai-portal'
    static_configs:
      - targets: ['{{ ansible_host }}:{{ pai_portal_port }}']
        labels:
          instance: 'pai-portal'
          service: 'pai-portal'
    metrics_path: '/api/status_all'
    scrape_interval: 30s

  # Jimmy's YouTube System
  - job_name: 'jimmy-youtube'
    static_configs:
      - targets: ['{{ ansible_host }}:{{ jimmy_youtube_port }}']
        labels:
          instance: 'jimmy-youtube'
          service: 'youtube-automation'
    metrics_path: '/api/status'
    scrape_interval: 60s

  # Grafana Monitoring
  - job_name: 'grafana'
    static_configs:
      - targets: ['{{ ansible_host }}:{{ grafana_port }}']
        labels:
          instance: 'grafana-server'
          service: 'grafana'
    metrics_path: '/api/health'
    scrape_interval: 60s
